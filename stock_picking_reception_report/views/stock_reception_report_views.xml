<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="stock_reception_report_form" model="ir.ui.view">
        <field name="name">stock.reception.report.form</field>
        <field name="model">stock.reception.report</field>
        <field name="arch" type="xml">
            <form string="Stock Reception Report">
                <header>
                    <button name="confirm_picking" states="draft" string="Confirm" type="object" class="oe_highlight"/>
                    <button name="print_picking" string="Print" type="object" class="oe_highlight"/>
                    <button name="cancel_picking" string="Cancel" type="object" states="done"/>
                    <field name="state" widget="statusbar" statusbar_visible="draft,done"/>
                </header>
                <sheet>
                    <div class="oe_title">
                        <h1>
                            <field name="name" class="oe_inline" readonly="1"/>
                        </h1>
                    </div>
                    <group>
                        <field name="user_id"/>
                        <field name="partner_id"/>
                    </group>
                    <group>
                        <field name="FechaRecepcion" />
                        <field name="picking_type_id"/>
                    </group>
                    <notebook>
                        <page string="Reception">
                            <separator string="Pickings"/>
                            <field name="picking_ids" widget="many2many" domain="[('picking_type_id.code', '=', 'incoming')]" options="{'not_delete': True}">
                                <tree>
                                    <field name="name"/>
                                    <field name="backorder_id"/>
                                    <field name="origin"/>
                                    <field name="date"/>
                                    <field name="scheduled_date"/>
                                    <field name="state"/>
                                    <button name="action_assign" string="Confirm picking" type="object" icon="fa-check text-success" attrs="{'invisible': [('state', 'in', ('done', 'cancel', 'confirmed', 'assigned'))]}"/>
                                    <button name="action_cancel" string="Cancel picking" type="object" icon="fa-times-circle text-danger" attrs="{'invisible': [('state', 'in', ('done', 'cancel'))]}"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <div class="oe_chatter">
                    <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                    <field name="message_ids" widget="mail_thread"/>
                </div>
            </form>
        </field>
    </record>

    <record id="stock_reception_report_tree" model="ir.ui.view">
        <field name="name">stock.reception.report.tree</field>
        <field name="model">stock.reception.report</field>
        <field name="arch" type="xml">
            <tree string="Stock Reception Report" decoration-muted="state=='cancel'">
                <field name="name"/>
                <field name="FechaRecepcion"/>
                <field name="user_id"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <record id="stock_reception_report_kanban" model="ir.ui.view">
        <field name="name">stock.reception.report.kanban</field>
        <field name="model">stock.reception.report</field>
        <field name="arch" type="xml">
            <kanban class="o_kanban_mobile">
                <field name="name"/>
                <field name="FechaRecepcion"/>
                <field name="user_id"/>
                <field name="state"/>
                <templates>
                    <t t-name="kanban-box">
                        <div t-attf-class="oe_kanban_global_click">
                            <div class="o_kanban_record_top mb16">
                                <div class="o_kanban_record_headings">
                                    <strong class="o_kanban_record_title">
                                        <field name="name"/>
                                    </strong>
                                </div>
                                <field name="state" widget="kanban_label_selection"/>
                            </div>
                            <div class="o_kanban_record_bottom">
                                <div class="oe_kanban_bottom_left">
                                    <field name="FechaRecepcion" />
                                </div>
                                <div class="oe_kanban_bottom_right">
                                    <img t-att-src="kanban_image('res.users', 'image_small', record.user_id.raw_value)" t-att-title="record.user_id.value" width="24" height="24" class="oe_kanban_avatar"/>
                                </div>
                            </div>
                        </div>
                    </t>
                </templates>
            </kanban>
        </field>
    </record>

    <record id="stock_reception_report_action" model="ir.actions.act_window">
        <field name="name">Reception Report</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">stock.reception.report</field>
        <!-- <field name="view_type">form</field> -->
        <field name="view_mode">tree,kanban,form</field>
        <field name="context">{"search_default_draft" : True,}</field>
        <!-- <field name="search_view_id" ref="stock_reception_report_filter"/> -->
        <field name="help" type="html">
            <p class="oe_view_nocontent_create">
            Click to create a Reception Report.
            </p>
            <p>
            The goal of the reception report is to group operations that may
            (needs to) be done together in order to increase their efficiency.
            It may also be useful to assign jobs (one person = one reception report) or
            help the timing management of operations (tasks to be done at 1pm).
            </p>
        </field>
    </record>

    <menuitem action="stock_reception_report_action" id="stock_reception_report_menu" parent="stock.menu_stock_warehouse_mgmt" sequence="10"/>

    <record id="vpicktree_inherit_stock_reception_report" model="ir.ui.view">
        <field name="name">stock.picking.tree</field>
        <field name="model">stock.picking</field>
        <field name="inherit_id" ref="stock.vpicktree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='picking_type_id']" position="after">
                <field name="receptionreport_id"/>
            </xpath>
        </field>
    </record>


</odoo>
